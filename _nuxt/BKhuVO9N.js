import{_ as M}from"./DN2dgNMu.js";import{_ as R}from"./Bwc820Ii.js";import{g as L,j as u,c as n,o,k as N,a as i,l as e,F as P,r as q,n as V,t as h,_ as z,m as A,p as B,q as F,b as x,s as G,v as I,w as O,d as J}from"./DJodKfqs.js";import{c as K,u as Q,f as U}from"./wFh4kOay.js";import{f as $}from"./BAkyND_4.js";const W={class:"flex justify-center items-center space-x-2 my-4"},X={class:"flex space-x-2 mx-2"},Y=["onClick"],Z={__name:"NewsPagination",props:{postsPerPage:{type:Number,required:!0},totalEntryCount:{type:Number,required:!0}},emits:["handlePageChange"],setup(y,{emit:l}){const f=y,_=l,p=L(),c=u(()=>Number(p.query.page)||1),m=u(()=>Math.ceil(f.totalEntryCount/f.postsPerPage)),b=u(()=>{const t=m.value,s=c.value;return t<=5?Array.from({length:t},(a,d)=>d+1):s<=2?[1,2,3,4,5]:s>=t-1?[t-4,t-3,t-2,t-1,t]:[s-2,s-1,s,s+1,s+2]});function g(t){_("handlePageChange",t)}return(t,s)=>(o(),n("div",W,[e(c)!==1?(o(),n("button",{key:0,onClick:s[0]||(s[0]=a=>g(1)),class:"text-gray-400 hover:text-link-color transition","aria-label":"最初のページへ"},"<")):N("",!0),i("ul",X,[(o(!0),n(P,null,q(e(b),a=>(o(),n("li",{key:a},[i("button",{onClick:d=>g(a),class:V(["w-8 h-8 flex items-center justify-center rounded font-bold text-sm",e(c)===a?"border border-link-color text-link-color":"text-gray-500 hover:text-white hover:bg-link-color transition"])},h(a),11,Y)]))),128))]),e(c)!==e(m)?(o(),n("button",{key:1,onClick:s[1]||(s[1]=a=>g(e(m))),class:"text-gray-400 hover:text-link-color transition","aria-label":"最後のページへ"},">")):N("",!0)]))}},ee={},te={class:"fixed inset-0 z-[1000] flex items-center justify-center"};function se(y,l){return o(),n("div",te,l[0]||(l[0]=[i("div",{class:"w-14 h-14 rounded-full border-[5px] border-cyan-100 border-t-primary-light-blue animate-spin"},null,-1)]))}const ne=z(ee,[["render",se]]),oe={class:"relative px-4 md:px-14 py-4 md:py-12 max-w-6xl mx-auto md:mt-8 min-h-[300px]"},ae={class:"absolute top-0 -right-[40%] w-[100%] h-[500px] min-w-80 min-h-[250px] md:bg-primary-light-green-opacity -z-10 opacity-0"},re={key:0},ie={key:1},le={key:2},ce={className:"text-lg font-bold"},ue={className:"text-sm text-gray-700"},me=["innerHTML"],de={key:3},_e={key:4,class:"grid max-w-4xl"},pe={class:"text-sm text-gray-500 mb-1"},w=10,ye={__name:"news",setup(y){const l=L(),f=A(),_=u(()=>l.query.slug),p=u(()=>Number(l.query.page)||1),{locale:c}=B(),m=F(),b=u(()=>m.public.localeMap[c.value]),g=K({space:m.public.contentfulSpace,accessToken:m.public.contentfulToken}),{data:t,pending:s,error:a}=Q(()=>`news-${_.value??""}-${p.value??1}-${c.value}`,async()=>U({skip:(p.value-1)*w,limit:w,slug:_.value,client:g,locale:b.value}),{watch:[()=>c.value],server:!1}),d=u(()=>{var r,k;return _.value?(k=(r=t.value)==null?void 0:r.newsList)==null?void 0:k[0]:null}),S=u(()=>{var r;return((r=t.value)==null?void 0:r.newsList)??[]}),T=r=>{p.value!==r&&f.push({query:{...l.query,page:r}})};return(r,k)=>{var C;const D=M,E=R,j=Z,H=I("intersect");return o(),n(P,null,[x(D,{title:"News"}),i("section",oe,[G(i("div",ae,null,512),[[H,{direction:"right"}]]),e(s)?(o(),n("div",re,[x(ne)])):e(a)?(o(),n("div",ie,"記事の取得に失敗しました")):e(d)?(o(),n("div",le,[i("h2",ce,h(e(d).title),1),i("p",ue,h(e($)(e(d).date)),1),i("div",{className:"mt-4 pb-8 prose prose-neutral max-w-none",innerHTML:e(d).body},null,8,me)])):e(_)?(o(),n("div",de,"記事が見つかりません。")):(o(),n("div",_e,[(o(!0),n(P,null,q(e(S),v=>(o(),n("div",{key:v.slug,class:"pb-6"},[i("p",pe,h(e($)(v.date)),1),x(E,{to:`/news?slug=${v.slug}`,class:"text-sm md:text-base mb-1 hover:underline"},{default:O(()=>[J(h(v.title),1)]),_:2},1032,["to"])]))),128)),x(j,{"total-entry-count":((C=e(t))==null?void 0:C.total)||0,"posts-per-page":w,onHandlePageChange:T},null,8,["total-entry-count"])]))])],64)}}};export{ye as default};
